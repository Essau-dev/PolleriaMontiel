<header class="site-header">
    <div class="container">
        {# Logo del negocio #}
        <a href="{{ url_for('main.index') }}" class="site-header__logo">
            {# Usar la variable config para el alt text del logo #}
            <img src="{{ url_for('static', filename='img/logo.png') }}" alt="{{ config.NOMBRE_NEGOCIO }}" class="site-logo">
        </a>
        <nav class="site-header__nav">
            {# Botón para el menú hamburguesa (visible solo en mobile) #}
            <button class="menu-toggle" aria-label="Toggle navigation" aria-expanded="false" aria-controls="navMenu">
                ☰ <!-- Icono de hamburguesa simple -->
            </button>
            {# Menú de navegación principal #}
            <ul class="nav-menu" id="navMenu"> {# Añadir ID para referenciar con JS #}
                {# Verificar si el usuario está autenticado para mostrar opciones #}
                {% if current_user and current_user.is_authenticated %}
                    {# Enlace a Inicio #}
                    {# Usar request.endpoint para marcar el enlace activo #}
                    <li class="{{ 'active' if request.endpoint == 'main.index' }}">
                        <a href="{{ url_for('main.index') }}">Inicio</a>
                    </li>
                    {# Enlace a Pedidos #}
                    {# Verificar si el endpoint actual pertenece al blueprint 'pedidos' #}
                    <li class="{{ 'active' if request.endpoint.startswith('pedidos.') }}">
                        <a href="{{ url_for('pedidos.dashboard_pedidos') }}">Pedidos</a>
                    </li>
                    {# Enlace a Caja #}
                     {# Verificar si el endpoint actual pertenece al blueprint 'caja' #}
                    <li class="{{ 'active' if request.endpoint.startswith('caja.') }}">
                        <a href="{{ url_for('caja.dashboard_caja') }}">Caja</a>
                    </li>

                    {# Menú Dropdown para Administrador #}
                    {# Usar el método is_admin() del modelo Usuario #}
                    {% if current_user.is_admin() %}
                        {# Verificar si el endpoint actual pertenece a los blueprints de Admin #}
                        <li class="dropdown {{ 'active' if request.endpoint.startswith(('clientes.', 'productos.', 'auth.')) }}">
                            {# El enlace del dropdown no navega, solo abre/cierra el submenú #}
                            <a href="#" class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">Admin ▾</a>
                            <ul class="dropdown-menu">
                                {# Enlaces del submenú Admin #}
                                <li class="{{ 'active' if request.endpoint.startswith('clientes.') }}">
                                    <a href="{{ url_for('clientes.listar_clientes') }}">Clientes</a>
                                </li>
                                <li class="{{ 'active' if request.endpoint.startswith('productos.') }}">
                                    <a href="{{ url_for('productos.dashboard_productos') }}">Productos</a>
                                </li>
                                <li class="{{ 'active' if request.endpoint.startswith('auth.') }}">
                                    <a href="{{ url_for('auth.listar_usuarios') }}">Usuarios</a>
                                </li>
                                {# <li><a href="#">Configuración</a></li> #}
                            </ul>
                        </li>
                    {% endif %}
                    {# Enlace para Cerrar Sesión #}
                    <li><a href="{{ url_for('auth.logout') }}">Cerrar Sesión ({{ current_user.username }})</a></li>
                {% else %}
                    {# Enlace para Iniciar Sesión (visible si no está autenticado) #}
                    <li class="{{ 'active' if request.endpoint == 'auth.login' }}">
                        <a href="{{ url_for('auth.login') }}">Iniciar Sesión</a>
                    </li>
                    {# Opcional: Enlace para Registro (solo si se permite registro público o para Admin) #}
                    {# <li><a href="{{ url_for('auth.registro_usuario') }}">Registrar (Admin)</a></li> #}
                {% endif %}
            </ul>
        </nav>
    </div>
</header>
